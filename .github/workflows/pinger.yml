name: Pinger

on:
  schedule:
    - cron: "*/12 * * * *"   # every 12 minutes
  workflow_dispatch:         # allow manual runs

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping backend to prevent sleep
        env:
          URL: https://cognify-backend-dymx.onrender.com/
        run: |
          echo "üîî Pinging $URL at $(date)"
          STATUS=$(curl -s -o /dev/null -w "%{http_code}" "$URL" --max-time 30)
          echo "üì° Response code: $STATUS"
          if [ "$STATUS" -eq 200 ] || [ "$STATUS" -eq 404 ]; then
            echo "‚úÖ Server is awake (status $STATUS)"
            exit 0
          else
            echo "‚ö†Ô∏è Unexpected status $STATUS, but server responded"
            exit 0
          fi